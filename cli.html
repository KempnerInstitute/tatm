

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tatm CLI &mdash; tatm  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tatm Data Module" href="data.html" />
    <link rel="prev" title="Dataset Metadata" href="metadata.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            tatm
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_dataset.html">Loading Text Data for LLM Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Dataset Metadata</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">tatm</span></code> CLI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#organization">Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#commands">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tatm-run"><code class="docutils literal notranslate"><span class="pre">tatm</span> <span class="pre">run</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tatm-data"><code class="docutils literal notranslate"><span class="pre">tatm</span> <span class="pre">data</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tatm-data-create-metadata"><code class="docutils literal notranslate"><span class="pre">tatm</span> <span class="pre">data</span> <span class="pre">create-metadata</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tatm-tokenize"><code class="docutils literal notranslate"><span class="pre">tatm</span> <span class="pre">tokenize</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html"><code class="docutils literal notranslate"><span class="pre">tatm</span></code> Data Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuring <code class="docutils literal notranslate"><span class="pre">tatm</span></code></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">tatm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">tatm</span></code> CLI</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cli.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tatm-cli">
<h1><code class="docutils literal notranslate"><span class="pre">tatm</span></code> CLI<a class="headerlink" href="#tatm-cli" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">tatm</span></code> library includes a command-line interface (CLI) that provides a set of tools for interacting with the library. The CLI is designed to be
easy to use and to provide a consistent interface for common tasks. The CLI is built using the <code class="docutils literal notranslate"><span class="pre">click</span></code> library, which provides a simple and
intuitive way to define command-line interfaces in Python. All commands include a help message that describes the command and provides detailed
information on the options that can be accessed by passing a <code class="docutils literal notranslate"><span class="pre">--help</span></code> flag. This document provides an overview of the commands available in the
<code class="docutils literal notranslate"><span class="pre">tatm</span></code> CLI and how to use them.</p>
<section id="organization">
<h2>Organization<a class="headerlink" href="#organization" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">tatm</span></code> CLI consists of both top level commands and (where needed) subcommands. This documment is organized following the structure of the CLI.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>Installing the <code class="docutils literal notranslate"><span class="pre">tatm</span></code> library will automatically install the CLI to your environment.</p>
<p><strong>DETAILED INSTALLATION INSTRUCTIONS TO BE ADDED</strong></p>
</section>
<section id="commands">
<h2>Commands<a class="headerlink" href="#commands" title="Link to this heading"></a></h2>
<section id="tatm-run">
<h3><code class="docutils literal notranslate"><span class="pre">tatm</span> <span class="pre">run</span></code><a class="headerlink" href="#tatm-run" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Usage: tatm run [OPTIONS] [WRAPPED_COMMAND]...

  The `tatm run` command is used to wrap other tatm commands and run them in a
  specified compute environment. It uses the configuration files and options
  to determine how to run the command. `tatm run` will use a template submit
  script along with your specified environment to run the command. It will
  then submit the job to the compute environment. If you do not want to submit
  the job, you can use the `--no-submit` flag. The generated submit script
  will be placed in the current working directory. The submit script will be
  named `tatm_{command}.submit` where `{command}` is the command you are
  running unless you specify a different name with the `--submit-script`
  option.

  If the script is not submitted the command will print the submit command to
  the console.

  The WRAPPED_COMMAND argument is the command that will be run. Currently only
  wrapping ray based commands on slurm is supported.

Options:
  --config, --conf TEXT           Path to configuration file or specific
                                  configuration settings. First, all config
                                  files are merged, then all config options
                                  are merged. Command line options override
                                  config file options. CLI config options
                                  should be in the format
                                  `field.subfield=value`. For list types, use
                                  dotlist notation (e.g.
                                  `field.subfield=[1,2,3]`). Note that this
                                  will override any list values in the config
                                  file. Also note that this may cause issues
                                  with your shell, so be sure to quote the
                                  entire argument.
  -N, --nodes INTEGER             Number of nodes to use for wrapped command.
  -c, --cpus-per-task, --cpus INTEGER
                                  Number of CPUs to use per task.
  --submit-script TEXT            Path to submit script to create.
  --time-limit TEXT               Time limit for the job.
  --memory, --mem TEXT            Memory to allocate for the job.
  --gpus-per-node TEXT            Number of GPUs to use per node.
  --constraints TEXT              Constraints for the job.
  -o, --log-file TEXT             Log file for the job.
  -e, --error-file TEXT           Error file for the job.
  --submit / --no-submit          Submit the job after creating the submit
                                  script. Set to False to only create the
                                  submit script.
  --help                          Show this message and exit.
</pre></div>
</div>
<p>Example usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tatm<span class="w"> </span>run<span class="w"> </span>--conf<span class="w"> </span>slurm.partition<span class="o">=</span>example<span class="w"> </span>--conf<span class="w"> </span>slurm.account<span class="o">=</span>example<span class="w"> </span>-N<span class="w"> </span><span class="m">4</span><span class="w"> </span>-c<span class="w"> </span><span class="m">40</span><span class="w"> </span>tokenize<span class="w"> </span>--output-dir<span class="w"> </span>/<span class="nv">$OUTPUT_DIR</span>/test_tatm_out/tokenize<span class="w"> </span>-v<span class="w"> </span>/<span class="nv">$DATADIR</span>/redpajama-v1/
</pre></div>
</div>
<p>will run the <code class="docutils literal notranslate"><span class="pre">tokenize</span></code> command with the specified configuration file create a 4 node, 160 CPU ray cluster and tokenize the dataset located at <code class="docutils literal notranslate"><span class="pre">/DATADIR/redpajama-v1/</span></code> and output the tokenized data to <code class="docutils literal notranslate"><span class="pre">/OUTPUT_DIR/test_tatm_out/tokenize</span></code> using 158 workers (2 CPUS are reserved for the writer and reader processes).</p>
<p>The submission script will be created in the current working directory and will be named <code class="docutils literal notranslate"><span class="pre">tatm_tokenize.submit</span></code>. The executed command will be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/usr/bin/sbatch --nodes 4 --cpus-per-task 40 --mem 40G --time 1-00:00:00 --partition example --account example --job-name tatm_tokenize --output tatm_tokenize.out $PWD/tatm_tokenize_job.submit
</pre></div>
</div>
</section>
<section id="tatm-data">
<h3><code class="docutils literal notranslate"><span class="pre">tatm</span> <span class="pre">data</span></code><a class="headerlink" href="#tatm-data" title="Link to this heading"></a></h3>
<p>The data command provides a set of sub commands for with the data layer functionality of the library.</p>
<section id="tatm-data-create-metadata">
<h4><code class="docutils literal notranslate"><span class="pre">tatm</span> <span class="pre">data</span> <span class="pre">create-metadata</span></code><a class="headerlink" href="#tatm-data-create-metadata" title="Link to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">create-metadata</span></code> command kicks off an interactive process to create a metadata file for a dataset. This metadata file
encodes information about the dataset, such as the location of the data files, the format of the data, and any other relevant
information. The metadata file is used by the library to load and process the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span> <span class="n">tatm</span> <span class="n">data</span> <span class="n">create</span><span class="o">-</span><span class="n">metadata</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="p">]</span>

<span class="n">Options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">help</span>  <span class="n">Show</span> <span class="n">this</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span><span class="o">.</span>
</pre></div>
</div>
</section>
</section>
<section id="tatm-tokenize">
<h3><code class="docutils literal notranslate"><span class="pre">tatm</span> <span class="pre">tokenize</span></code><a class="headerlink" href="#tatm-tokenize" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Usage: tatm tokenize [OPTIONS] [DATASETS]...

  Tokenize a dataset using the tatm ray based tokenization engine. If running
  in a cluster environment, it is recommended to use this command in
  conjunction with the `run` command to submit the tokenization job to the
  cluster.

  This command will tokenize the input datasets using the specified tokenizer
  and output the tokenized data to the specified output directory as  a series
  of binary files. The number of workers to use for tokenization can be
  specified using the `--num-workers` option. If not specified, the number of
  workers will be determined by the number of available CPUs  to the ray
  cluster.

  Arguments: DATASETS: Paths to the datasets to tokenize. This command can
  accept multiple datasets to tokenize. All datasets are expected to have a
  tatm metadata file associated with them.

Options:
  --num-workers TEXT  Number of workers to use for tokenization
  --tokenizer TEXT    Tokenizer to use for tokenization
  --output-dir PATH   Output directory for tokenized data
  -v, --verbose       Enable verbose logging
  --file-prefix TEXT  Prefix for tokenized files
  --token-dtype TEXT     Numpy data type for tokenized files
  --help              Show this message and exit.
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="metadata.html" class="btn btn-neutral float-left" title="Dataset Metadata" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data.html" class="btn btn-neutral float-right" title="tatm Data Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Kempner Institute at Harvard University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>